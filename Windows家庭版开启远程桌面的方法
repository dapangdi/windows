一、背景介绍
 Windows家庭版提示不支持远程桌面，如下图Windows11家庭版：

本文将介绍一种Windows家庭版开启远程桌面的方法，分为开启远程桌面设置、配置问题排查及解决：

安装远程桌面补丁文件；
手动开启“远程协助”，防火墙开放端口；
RDP Wrapper自救指南；
远程桌面设置常见问题排查和解决。

二、安装补丁
1、下载补丁并解压，下载链接：https://github.com/stascorp/rdpwrap
注意：用谷歌浏览器会提示危险文件，选择“保留危险文件”即可。如果大家不放心，请用杀软进行查杀。
2、选择“install.bat”右键，选择“以管理员身份运行”进行安装，安装成功则如下提示。
3、选择“RDPConf.exe”右键，选择“以管理员身份运行”查看相关信息，如下图则表示安装成功。
此时，就能远程控制该机器了！

三、手动开启“远程协助”，防火墙开放端口
1、点击“Windows图标”打开开始菜单，然后找到点击“设置”进入设置界面。
2、在“系统”中选择“关于”或“系统信息”，然后点击“高级系统设置”进入系统属性。
然后选择“远程”选项卡并勾选“允许远程协助连接这台计算机”，最后点击“应用”保存配置。
3、按“Win+S”键和输入“控制面板”进入控制面板界面，然后选择“系统和安全 > Windows Defender 防火墙 > 允许应用或功能通过Windows Defender防火墙”，最后确保远程协助已允许。


四、RDP Wrapper自救指南
 当RDP Wrapper初始状态Service state为Stopped时，应该如何排查和解决呢？
 1、关闭防火墙/网络防火墙、退出杀毒软件。
 2、重启电脑，手动复制rdpwrap.dll至C:\Program Files\RDP Wrapper，卸载后重新install
结果：Wrapper ver正常出现
 3、检查防火墙配置是否允许3389端口
 4、uninstall RDP Wrapper，重新安装，就可以了：
 5、最后记得重新启用网络防火墙：

五、远程桌面设置常见问题排查和解决
 1、rdpwrap下载安装之后，安装目录缺失rdpwrap.dll或rdpwrap.ini文件
没有rdpwrap.dll文件，先去https://github.com/stascorp/rdpwrap/issues/1883网址手动下载后，复制到安装路径下：
再然后卸载->安装，看看有没有rdpwrap.ini文件，没有的话去网址https://github.com/sebaxakerhtc/rdpwrap.ini/tree/master/autogenerated，根据termsrv ver.后面的版本号，将里面内容复制到安装路径下，然后重启电脑

2、已经显示绿色 fully supported，但是无论如何操作 Listener state都是红色Not Listening 
 解决方案（两种解决方案都可以试试）：
检查下C:\Program Files\RDP Wrapper\rdpwarp.ini文件，看是不是刚才生成的ini配置文件粘贴错了位置，不能粘贴在文件最底端，要求粘贴到同类型配置文件的最顶端。
重启服务，发现启动不了，被篡改了注册表解决方法可参考https://blog.csdn.net/qq_35903121/article/details/104342391，按照上面操作后，命令行起终端管理员，然后执行net start TermService命令即可。

3、RDP Wrapper其他都绿了，但是termsrv ver无法显示，support level也不为绿
解决方案：
这种情况可能是软件界面显示问题，理论上已经可以被远程，可以电脑远程试一下。

4、RDP Wrapper都配置OK，刚开始试过可以远程，但过段时间再远程不了电脑
解决方案：
记得去设置里调一下电源选项，要不然息屏后睡眠会断网。系统--电源--“插入电源时，在闲置以下时间后将设备置于睡眠状态”：选择【从不】

5、配置成功后未重启，开启防火墙后就无法远程
解决方案：
配置后开启防火墙，记得需重启电脑哦！

6、可以远程成功后，重启无法远程
在病毒和威胁防护中，查看“保护历史记录”
 将拦截记录设置为“此威胁或应用被允许”
再次尝试远程检查远程服务是否启动，“cmd”以管理员身份运行命令：net start termService


原文连接:
https://www.cnblogs.com/jingliangxiaozi/p/18143143
https://www.cnblogs.com/ministep/p/15829494.html
